import numpy as np

x = [8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824]
# y_intra = [0.000000446, 0.000000295, 0.000000302, 0.000000306, 0.000000355, 0.000000373, 0.000000588, 0.000000636, 0.000000756, 0.000002423, 0.000003055, 0.000003974, 0.000005336, 0.000008059, 0.000013336, 0.000024314, 0.000045373, 0.000081852, 0.000155939, 0.000492048, 0.001305051, 0.002673494, 0.00539996, 0.010787497, 0.021972588, 0.042552521, 0.082991089, 0.168396058]
y_intra = [0.000000406, 0.000000244, 0.000000523, 0.000000402, 0.000000564, 0.000000592, 0.000000597, 0.000000680, 0.000000748, 0.000002139, 0.000002667, 0.000003466, 0.000004396, 0.000006627, 0.000011114, 0.000020417, 0.000158795, 0.000074688, 0.000316531, 0.001157599, 0.002631885, 0.003857160, 0.005373242, 0.010553650, 0.020727785, 0.040637550, 0.080326486, 0.159385863]

y_inter = [0.000053885, 0.000053324, 0.000053329, 0.00005322, 0.000053068, 0.000052929, 0.000052826, 0.000061053, 0.000092799, 0.000092487, 0.00017566, 0.000208156, 0.000386743, 0.000754518, 0.001328073, 0.002558548, 0.004996472, 0.010817858, 0.023895512, 0.047600412, 0.072726169, 0.144779066, 0.29132094, 0.589569401, 1.257257961, 2.353205263, 4.648220828, 9.279981464]

p1_intra, p2_intra = np.polyfit(x, y_intra, 1)

p1_inter, p2_inter = np.polyfit(x, y_inter, 1)

print(f"Intra node: \nLatency: {p2_intra / 1e-6} us\nBandwidth: {1 / p1_intra / 1e9} GB/s")
print()
print(f"Inter node: \nLatency: {p2_inter / 1e-6} us\nBandwidth: {1 / p1_inter / 1e9} GB/s")